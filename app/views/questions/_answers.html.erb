<div id="questions_all">
  <div class="py-6">
    <h2 class="text-xl justify-center font-semibold p-4"> <%= @answers.count %> Respuesta(s)</h2>
    <div>
      <% @answers.each do |answer| %>
        <div class="flex p-4">
          <div class="flex flex-col mr-4">
            <% if current_user && !current_user.votes.exists?(votable: answer) %>
              <%= button_to question_answer_votes_path(@question, answer) do %>
                <i class="fa-regular fa-circle-up text-3xl"></i>
                <p class="text-center"> <%= answer.votes.count %></p>
              <% end %>
            <% elsif current_user && current_user.votes.find_by(votable: answer) %>
              <%= button_to question_answer_vote_path(@question, answer), method: :delete do %>
                <i class="fa-solid fa-circle-up text-3xl"></i>
                <p class="text-center"><%= answer.votes.count %></p>
              <% end %>
            <% else %>
              <i class="fa-regular fa-circle-up text-3xl"></i>
              <p class="text-center"><%= answer.votes.count %></p>
            <% end %>
          </div>

          <div class="w-full">
            <% if answer.present? %>
              <p><%= answer.content %></p>
            <% else %>
              <p>Si conoces alguien que pueda responder esta pregunta por favor t√≠mbrale y dile que lo necesitamos con urgencia.</p>
            <% end %>
            
            <%= render partial: 'comments/comments', locals: { comments: answer.comments } %>
            <% if user_signed_in? %>
              <%= form_with(model: [ answer.question, answer, answer.comments.new ], local: true) do |f| %>
                <div class="field flex flex-col border-spacing-4">
                  <%= f.text_field :content, placeholder: 'Agrega un comentario', class: 'text-sm p-2 rounded-lg border-slate-300 border-2' %>
                </div>
                <div class="actions flex justify-end my-2">
                  <div class="p-2 bg-green-500 rounded-lg text-sm text-white font-semibold cursor-pointer">
                    <%= f.submit 'Comentar', class: 'cursor-pointer' %>
                  </div>
                </div>
              <% end %>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>

    <% if user_signed_in? %>
      <div>
        <h2 class="text-xl justify-center font-semibold p-4">Tu Respuesta</h2>
        <%= form_with(model: @answer, url: question_answers_path(@question), method: :post) do |f| %>
          <div class="field">
            <%= f.text_area :content, placeholder: 'Agrega una respuesta', class: 'text-sm p-2 rounded-lg border-slate-300 border-2 h-24 w-full'%>
          </div>
          <div class="actions flex justify-end my-2">
              <div class="p-2 bg-green-500 rounded-lg text-sm text-white font-semibold cursor-pointer">
                <%= f.submit "Enviar Respuesta", class: 'cursor-pointer' %>
              </div>
          </div>    
        <% end %>
      </div>
    <% end %>
  </div>
</div>